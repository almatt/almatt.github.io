<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="paybox"></div>
    <div id="paybox1"></div>
    <script src="https://p2p.paybox.kz/tokens/pay-buttons-client.js?v3"></script>
    <script>

        window.onload = () => {
            window.PayBoxPayButtons(
                'paybox',
                'CdLAdlGDTVZwvPhOBNsY5BotwMgVIN8b', // qZ0iGnvGZTMuU0RTdBHsCXe9XPPG2auw CdLAdlGDTVZwvPhOBNsY5BotwMgVIN8b
                {
                    amount: 123, description: 'asd'
                }, 
                success, 
                error, 
                canMake, 
                cantMake
            );

            function success(r) {
                console.log('success')
                console.log(r)
            }

            function error(r) {
                alert(alert(JSON.stringify(r, null, 4)))
                console.log(r)
            }

            function canMake() {
                console.log('canMake')
            }

            function canMakeA() {
                console.log('canMakeA')
            }

            function cantMake(err) {
                alert(JSON.stringify(err, null, 4))
                console.log(err)
            }

            window.PayBoxPayButtons(
                'paybox1',
                'CdLAdlGDTVZwvPhOBNsY5BotwMgVIN8b', // qZ0iGnvGZTMuU0RTdBHsCXe9XPPG2auw CdLAdlGDTVZwvPhOBNsY5BotwMgVIN8b
                {
                    amount: 456, description: 'asd'
                },
                success,
                error,
                canMakeA,
                cantMake
            );
        }
        
        // // client-script
        // setTimeout(async () => {
        //     const response = await window.ApplePaySession.canMakePaymentsWithActiveCard('merchant.kz.paybox.p2p');

        //     window.frames[0].postMessage({
        //         event: response
        //     },'*');
        // }, 2000);

        // window.addEventListener("message", receiveMessage, false);

        // function receiveMessage(event) {
        //     console.log(event);

        //     const options = {
        //             'total': {
        //                 'label': 'ApplePay',
        //                 'amount': 200,
        //             },
        //             'countryCode': 'KZ',
        //             'currencyCode': 'KZT',
        //             'merchantCapabilities': ['supports3DS'],
        //             'supportedNetworks': ['masterCard', 'visa']
        //     }

        //     const applePaySession = new window.ApplePaySession(1, options);

        //     applePaySession.onvalidatemerchant = function() { console.log('validation') };
        //     applePaySession.onpaymentauthorized = function() { console.log('paymentauth') };

        //     applePaySession.begin();
        // }
    </script>
</body>
</html>